# 司機申請審核系統 - 流程圖

## 📊 系統完整流程

```
┌─────────────────────────────────────────────────────────────────┐
│                    司機申請審核系統流程圖                           │
└─────────────────────────────────────────────────────────────────┘

┌──────────────┐
│   司機端      │
└──────────────┘
       │
       ▼
┌─────────────────────────────┐
│  1. 訪問註冊頁面              │
│     /auth/register           │
└─────────────────────────────┘
       │
       ▼
┌─────────────────────────────┐
│  2. 填寫 6 步驟表單          │
│     • 基本資料               │
│     • 設定密碼               │
│     • 駕照資料               │
│     • 車輛資料               │
│     • 緊急聯絡人             │
│     • 街口帳號（選填）       │
└─────────────────────────────┘
       │
       ▼
┌─────────────────────────────┐
│  3. 提交申請                │
│     ↓                       │
│     創建記錄到資料庫         │
│     • users 表              │
│     • driver_applications   │
│     • drivers 表            │
│     • vehicles 表           │
└─────────────────────────────┘
       │
       ▼
┌─────────────────────────────┐
│  4. 顯示成功畫面            │
│     ✓ 申請編號              │
│     ✓ 審核流程說明          │
│     ✓ 登入提示              │
│     ↓                       │
│     狀態：pending           │
└─────────────────────────────┘
       │
       │
       │  等待 1-3 個工作天
       │
       ▼
┌──────────────┐
│  管理員端     │
└──────────────┘
       │
       ▼
┌─────────────────────────────┐
│  5. 登入後台管理            │
│     /admin/auth/login       │
│     帳號：admin             │
│     密碼：ADMIN123          │
└─────────────────────────────┘
       │
       ▼
┌─────────────────────────────┐
│  6. 後台首頁                │
│     • 看到紅色徽章 🔴       │
│     • 顯示待審核數量         │
│     • 點擊「司機申請審核」   │
└─────────────────────────────┘
       │
       ▼
┌─────────────────────────────┐
│  7. 司機申請審核頁面        │
│     /admin/driver-applications│
│     • 申請列表              │
│     • 搜尋功能              │
│     • 狀態篩選              │
└─────────────────────────────┘
       │
       ▼
┌─────────────────────────────┐
│  8. 查看申請詳情            │
│     • 基本資料              │
│     • 駕照資料              │
│     • 車輛資料              │
│     • 緊急聯絡人            │
│     • 街口帳號              │
└─────────────────────────────┘
       │
       ▼
    ┌──────┐
    │ 審核  │
    └──────┘
       │
   ┌───┴───┐
   │       │
   ▼       ▼
┌──────┐ ┌──────┐
│ 通過  │ │ 拒絕  │
└──────┘ └──────┘
   │       │
   │       │
   │       ▼
   │    ┌─────────────────────────────┐
   │    │  輸入拒絕原因               │
   │    │  （至少 5 個字元）           │
   │    └─────────────────────────────┘
   │       │
   ▼       ▼
┌─────────────────────────────┐
│  9. 更新資料庫              │
│     • driver_applications   │
│       - status: approved    │
│         或 rejected         │
│       - reviewed_at         │
│       - reviewed_by         │
│     • users 表              │
│       - status: active      │
│         或 rejected         │
│     • 創建通知記錄          │
└─────────────────────────────┘
   │       │
   │       │
   ▼       ▼
┌─────────────────────────────┐
│  10. 發送通知給司機         │
│      ✅ 審核通過            │
│      ❌ 審核拒絕（含原因）  │
└─────────────────────────────┘
   │       │
   │       │
   ▼       ▼
┌──────────────┐ ┌──────────────┐
│ 司機可登入   │ │ 司機無法登入  │
│ 開始接單     │ │ 收到拒絕通知  │
└──────────────┘ └──────────────┘
```

---

## 🔄 狀態轉換圖

```
┌─────────────────────────────────────────────────────────────┐
│                        申請狀態流程                          │
└─────────────────────────────────────────────────────────────┘

   司機提交申請
        │
        ▼
   ┌─────────┐
   │ pending │  ← 初始狀態（待審核）
   │ 待審核   │
   └─────────┘
        │
    管理員審核
        │
    ┌───┴────┐
    │        │
    ▼        ▼
┌──────────┐ ┌──────────┐
│ approved │ │ rejected │
│ 已通過   │ │ 已拒絕   │
└──────────┘ └──────────┘
    │            │
    │            │
    ▼            ▼
┌──────────┐ ┌──────────┐
│  active  │ │ blocked  │
│ 可以登入 │ │ 無法登入 │
└──────────┘ └──────────┘
```

---

## 📱 頁面導航圖

```
┌──────────────────────────────────────────────────────────┐
│                    系統頁面結構                           │
└──────────────────────────────────────────────────────────┘

┌─────────────────┐
│   角色選擇頁面   │
│ /role-selection │
└─────────────────┘
        │
    ┌───┴────┐
    │        │
    ▼        ▼
┌─────────┐ ┌──────────┐
│ 司機端   │ │ 管理員端  │
└─────────┘ └──────────┘
    │            │
    │            │
    ▼            ▼
┌─────────────────────┐ ┌─────────────────────┐
│ /auth/register      │ │ /admin/auth/login   │
│ （司機註冊）         │ │ （管理員登入）       │
└─────────────────────┘ └─────────────────────┘
    │                        │
    │                        │
    │                        ▼
    │                   ┌─────────────────────┐
    │                   │ /admin              │
    │                   │ （後台首頁）         │
    │                   └─────────────────────┘
    │                        │
    │                        │
    │                        ▼
    │                   ┌─────────────────────────────┐
    │                   │ /admin/driver-applications  │
    │                   │ （司機申請審核頁面）         │
    │                   └─────────────────────────────┘
    │
    ▼
┌─────────────────────┐
│  成功提示頁面        │
│  • 申請編號          │
│  • 審核說明          │
│  • 3秒後自動返回     │
└─────────────────────┘
```

---

## 🎨 後台管理界面結構

```
┌────────────────────────────────────────────────────────────┐
│              後台管理 - 司機申請審核頁面                     │
└────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│  🔙 返回    司機申請審核           🔴 3 筆待審核           │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│  🔍 [搜尋框：姓名、電話、車牌...]                         │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│  [全部] [待審核] [審核中] [已通過] [已拒絕]               │
└──────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────┐
│  👤 張小明                              ⏰ 待審核           │
│  📱 0912345678                          🔴 高優先級         │
│  🚗 Toyota Prius (ABC-1234)                                │
│  📋 駕照：TEST123456                                       │
│  📅 提交時間：2025/10/03 18:30                             │
│                                                            │
│  [👁️ 查看詳情] [✅ 通過] [❌ 拒絕]                         │
└────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────┐
│  👤 李大華                              ✅ 已通過           │
│  📱 0923456789                          🟢 普通             │
│  🚗 Honda City (XYZ-5678)                                  │
│  📋 駕照：TEST654321                                       │
│  📅 提交時間：2025/10/02 14:20                             │
│  ✓ 審核時間：2025/10/03 09:15                              │
│                                                            │
│  [👁️ 查看詳情]                                             │
└────────────────────────────────────────────────────────────┘
```

---

## 💾 資料庫關聯圖

```
┌──────────────────────────────────────────────────────────┐
│                    資料庫表關係                           │
└──────────────────────────────────────────────────────────┘

┌─────────────────┐
│     users       │
│ ─────────────── │
│ id (PK)         │
│ phone_number    │◄────────┐
│ full_name       │         │
│ role            │         │ 關聯
│ status          │         │
│ ...             │         │
└─────────────────┘         │
        │                   │
        │ 1:1               │
        ▼                   │
┌─────────────────┐         │
│ driver_applications      │
│ ─────────────── │         │
│ id (PK)         │         │
│ user_id (FK) ───┼─────────┘
│ full_name       │
│ phone_number    │
│ status          │
│ priority        │
│ submitted_at    │
│ reviewed_at     │
│ reviewed_by     │
│ ...             │
└─────────────────┘
        │
        │ 1:1
        ▼
┌─────────────────┐
│    drivers      │
│ ─────────────── │
│ id (PK)         │
│ user_id (FK)    │
│ application_id  │
│ license_number  │
│ vehicle_model   │
│ ...             │
└─────────────────┘
        │
        │ 1:1
        ▼
┌─────────────────┐
│   vehicles      │
│ ─────────────── │
│ id (PK)         │
│ driver_id (FK)  │
│ license_plate   │
│ make            │
│ model           │
│ ...             │
└─────────────────┘
```

---

## ✅ 系統已完成！

所有流程和功能都已實施並可正常運作。
請參考本文檔了解完整的系統架構和流程。

🎉 立即開始使用您的司機申請審核系統！
